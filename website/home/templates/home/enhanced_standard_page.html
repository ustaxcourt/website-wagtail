{% extends 'base.html' %}
{% load wagtailcore_tags %}
{% load wagtailimages_tags %}
{% load filters %}
{% load static %}
{% block extra_css %}
    <style>
        .enhanced-page {
            .links {
                i {
                    padding-right: .4em
                }
            }

            .question-answer-block {
                display: flex;
                position: relative;

                .bookmark {
                    position: absolute;
                    left: -22px;
                    top: 24px;
                }
            }
            .usa-button {
                width: 95%;
                margin-top: 0.5em;
                margin-bottom: 0.5em;
                display: block;
                font-weight: normal;
                font-size: 17px;
                line-height: 24px;
            }

            .dedication {
                gap: 1rem;

                .dedication-image {
                    width: 480px;
                    float: right;
                    display: block;
                    padding: 20px 10px 20px 10px;

                    img {
                        box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.33);
                        width: 100%;
                        height: auto;
                        display: inline-block;
                        margin-bottom: 21px;
                    }
                }

                .dedication-text {
                    flex: 1;
                    font-size: 16px;

                    .title {
                        font-weight: bold;
                    }
                }
            }

            #video-container {

                .video-desc-block {
                    margin-top: 2em;
                    padding: 40px;
                    background-color: rgba(255, 255, 255, 1.00);
                    border-radius: 0px;
                    box-shadow: 0px 3px 10px rgba(0, 0, 0, 0.33);
                    display: flex;
                    align-items: flex-start;
                    gap: 20px;
                }

                .video-container iframe {
                    border: none;
                    width: 640px;
                    height: 360px;
                    border-width: 2px;
                    border-style: inset;
                }

                .description-block {
                    margin-top: -20px;

                    p {
                        margin-left: 40px;
                    }

                    blockquote {
                        font-size: 18px;
                        line-height: 1.45;
                        padding: 0.5rem 1rem;
                        margin-bottom: 1rem;
                        border-left: 0.25rem solid #eceeef;

                        cite {
                            display: block;
                            font-size: 17px;
                            color: #818a91;
                            font-style: italic;
                        }
                    }
                }
            }
        }


        @media (max-width: 1024px) {
            .enhanced-page {
                .question-answer-block {
                    .bookmark {
                        top: 24px;
                        left: -4px;
                    }

                    h3 {
                        padding-left: 16px;
                    }
                }
            }
        }
        @media (max-width: 768px) {
            #video-container {
                .video-desc-block {
                    flex-direction: column;
                    padding: 20px;
                    gap: 10px;
                }

                .video-container iframe {
                    width: 295PX !important;
                    height: 250px;
                }

                .description-block {
                    margin-top: 10px;
                    p {
                        margin-left: 0;
                    }
                }
            }
        }
    </style>
{% endblock %}
{% block body_class %}template-standard_page{% endblock %}
{% block content %}
    <div class="enhanced-page grid-container padding-bottom-2 padding-top-2">
        <h1 data-testid="page-title">{{ page.title }}</h1>
        <hr />
        {% if page.navigation_ribbon %}
            <div class="blue-page-links-bar">
                {% for link in page.navigation_ribbon.links.all %}
                <a href="{{ link.url }}"><i class="{{ link.icon }}"></i>
                <div class="title">{{ link.title }}</div>
            </a>
        {% endfor %}
    </div>
{% endif %}
{% for block in page.body %}
    {% with page_url=page.url|strip_trailing_slash %}
        {% if block.block_type == 'heading' %}
            <h2>{{ block.value }}</h2>
        {% elif block.block_type == 'h2' %}
            <h2>{{ block.value }}</h2>
        {% elif block.block_type == 'h3' %}
            <h3>{{ block.value }}</h3>
        {% elif block.block_type == 'h4' %}
            <h4>{{ block.value }}</h4>
        {% elif block.block_type == 'paragraph' %}
            <p data-testid="page-body-paragraph">{{ block.value }}</p>
        {% elif block.block_type == 'image' %}
            <img src="{{ block.value.url }}" alt="{{ block.value.alt }}">
        {% elif block.block_type == 'hr' %}
            <hr />
        {% elif block.block_type == 'links' %}
            <ul class="links {{ block.value.class }}">
                {% for link in block.value.links %}
                    {% if link.document %}
                        <li>
                            <a href="{{ link.document.url }}"
                               data-testid="document-link"
                               title="{{ link.title }}"><i class="{{ link.icon }}"></i> {{ link.title }}</a>
                        </li>
                    {% else %}
                        <li>
                            {% if link.url %}
                                <a href="{{ link.url }}" title="{{ link.title }}"><i class="{{ link.icon }}"></i> {{ link.title }}</a>
                            {% endif %}
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
        {% elif block.block_type == 'questionanswers' %}
            <ul class="links indented">
                {% for q in block.value %}
                    <li>
                        <a href="{{ page_url }}#{{ q.anchortag }}">
                            <i class="ti ti-info-circle-filled"></i>{{ q.question }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
            <hr />
            {% for q in block.value %}
                <div class="question-answer-block">
                    <a href="{{ page_url }}#{{ q.anchortag }}" title="{{ q.question }}">
                        <div class="ti ti-bookmark-filled bookmark" id="{{ q.anchortag }}"></div>
                    </a>
                    <h3>{{ q.question }}</h3>
                </div>
                <div>{{ q.answer|richtext }}</div>
                <hr />
            {% endfor %}
        {% elif block.block_type == "photo_dedication" %}
        <div class="dedication">
            {% if block.value.photo %}
            <div class="dedication-image">
                {% image block.value.photo width-200 alt=block.value.alt_text %}
            </div>
            {% endif %}
            <div class="dedication-text">
                <p class="title">{{ block.value.title }}</p>
                {{ block.value.paragraph_text | richtext }}
            </div>
        </div>
        {% elif block.block_type == 'embedded_video' %}
            <hr />
            <div id="video-container">
                <h2>{{ block.value.title }}</h2>
                <div class="video-desc-block">
                    <div class="video-container">
                        <iframe title="Victor Lundy:Sulptor of Space"
                                src="{{ block.value.video_url }}"
                                allowfullscreen></iframe>
                    </div>
                    <div class="description-block">
                        <p>{{ block.value.description }}</p>
                    </div>
                </div>
            </div>
        {% elif block.block_type == 'columns' %}
            {% with column_count=block.value.column|length %}
                <div class="grid-row">
                    {% for column in block.value.column %}
                        <div class="grid-col-12 tablet:grid-col-{{ column_count|column_width }}">
                            {% for sub_block in column %}
                                {% if sub_block.block_type == 'h2WithAnchorTag' %}
                                    <h2 id="{{ sub_block.value.anchortag }}">{{ sub_block.value.text }}</h2>
                                {% elif sub_block.block_type == 'clickableButton' %}
                                    <a href="{{ sub_block.value.url }}" class="usa-button">{{ sub_block.value.text }}</a>
                                {% endif %}
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            {% endwith %}
        {% else %}
            <p>Block type not recognized: {{ block.block_type }}</p>
            {{ block.value }}
        {% endif %}
    {% endwith %}
{% endfor %}
</div>
{% endblock content %}
